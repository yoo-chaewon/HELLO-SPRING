## 3. ìŠ¤í”„ë§AoP(Aspect Oriented Programming)

###### ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë° ğŸ‘‰ í©ì–´ì§„ ì½”ë“œë¥¼ í•œ ê³³ìœ¼ë¡œ ëª¨ì•„



- **í©ì–´ì§„ AAAA ì™€ BBBB**

```java
class A {
  method a () {
    	AAAA -> AAA
      ì˜¤ëŠ˜ì€ 7ì›” 4ì¼ ë¯¸êµ­ ë…ë¦½ ê¸°ë…ì¼ì´ë˜ìš”.
      BBBB -> BB
  }
  
  method b () {
    AAAA -> AAA
      ì €ëŠ” ì•„ì¹¨ì— ìš´ë™ì„ ë‹¤ë…€ì™€ì„œ ë°¥ë¨¹ê³  ë¹¨ë˜ë¥¼ í–ˆìŠµë‹ˆë‹¤.
      BBBB -> BB
  }
}

class B {
  	method c() {
    AAAA -> AAA
      ì ì‹¬ì€ ì´ê±° ì°ëŠë¼ ëª»ë¨¹ì—ˆëŠ”ë° ì €ë…ì—” ì œìœ¡ë³¶ìŒì„ ë¨¹ê³  ì‹¶ë„¤ìš”.
      BBBB -> BB
  }
}
```

> ì´ ê²½ìš°ì— AAAA ë¥¼ AAAë¡œ ë°”ê¾¸ê³  ì‹¶ìœ¼ë©´, AAAAë¥¼ ëª¨ë‘ ì°¾ì•„ì„œ ë°”ê¿”ì¤˜ì•¼í•¨.



- ëª¨ì•„ ë†“ì€ AAAA ì™€ BBBB

  > ê³µí†µì ìœ¼ë¡œ í•˜ëŠ” ì¼ë“¤ì„ ëª¨ìœ¼ë©´ ì•ˆë˜ë‚˜?

```java
class A {
  method a () {
    ì˜¤ëŠ˜ì€ 7ì›” 4ì¼ ë¯¸êµ­ ë…ë¦½ ê¸°ë…ì¼ì´ë˜ìš”.
  }

  method b () {
    ì €ëŠ” ì•„ì¹¨ì— ìš´ë™ì„ ë‹¤ë…€ì™€ì„œ ë°¥ë¨¹ê³  ë¹¨ë˜ë¥¼ í–ˆìŠµë‹ˆë‹¤.
  }
}


class B {
  method c() {
    ì ì‹¬ì€ ì´ê±° ì°ëŠë¼ ëª»ë¨¹ì—ˆëŠ”ë° ì €ë…ì—” ì œìœ¡ë³¶ìŒì„ ë¨¹ê³  ì‹¶ë„¤ìš”.
  }
}

class AAAABBBB {
  method aaaabbb(JoinPoint point) {
    	AAAA
      point.execute()
      BBBB
  }
}
```

ğŸ‘‰ ì´ëŸ°ê²ƒì´ AOPì„,



#### ë‹¤ì–‘í•œ AOP êµ¬í˜„ ë°©ë²•

â—   **ì»´íŒŒì¼ ê³¼ì •ì—** A.java ----(AOP)---> A.class ([AspectJ](https://www.eclipse.org/aspectj/))

â—   **ë°”ì´íŠ¸ì½”ë“œ ì¡°ì‘** A.java -> A.class ---(AOP)---> ë©”ëª¨ë¦¬ (AspectJ)

â—   **í”„ë¡ì‹œ íŒ¨í„´** (`ìŠ¤í”„ë§ AOP`)

â€‹		-> ê¸°ì¡´ì˜ ì½”ë“œë¥¼ ê±´ë“¤ì´ì§€ ì•Šê³  ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì´ ì½”ë“œì— ë„£ì„ ìˆ˜ ìˆëŠ”ê°€,



#### í”„ë¡ì‹œ íŒ¨í„´

- https://refactoring.guru/design-patterns/proxy

- ê¸°ì¡´ ì½”ë“œ ê±´ë“œë¦¬ì§€ ì•Šê³  ìƒˆ ê¸°ëŠ¥ ì¶”ê°€í•˜ê¸° -> ìŠ¤í”„ë§ì—ì„œëŠ” ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§.



### AOP ì ìš© ì˜ˆì œ

##### @LogExecutionTime ìœ¼ë¡œ ë©”ì†Œë“œ ì²˜ë¦¬ ì‹œê°„ ë¡œê¹…í•˜ê¸°

#### @LogExecutionTime ì• ë…¸í…Œì´ì…˜ (ì–´ë””ì— ì ìš©í• ì§€ í‘œì‹œ í•´ë‘ëŠ” ìš©ë„)

```java
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface LogExecutionTime {
}

```

### ì‹¤ì œ Aspect (@LogExecutionTime ì• ë…¸í…Œì´ì…˜ ë‹¬ë¦°ê³³ì— ì ìš©)

```java
@Component
@Aspect
public class LogAspect {

   Logger logger = LoggerFactory.getLogger(LogAspect.class);

   @Around("@annotation(LogExecutionTime)")
   public Object logExecutionTime(ProceedingJoinPoint joinPoint) throws Throwable {
       StopWatch stopWatch = new StopWatch();
       stopWatch.start();

       Object proceed = joinPoint.proceed();

       stopWatch.stop();
       logger.info(stopWatch.prettyPrint());

       return proceed;
   }

}
 
```



 



 

 

 



 



 